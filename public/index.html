<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Validation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        #validEmailsBox, #invalidEmailsBox {
            width: 100%;
            height: 150px;
            border: 1px solid #ccc;
            overflow-y: scroll;
            margin-top: 20px;
            padding: 10px;
            background-color: #f9f9f9;
        }

        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background-color: #45a049;
        }

        #emailInput {
            padding: 10px;
            width: 300px;
        }

        /* Loading spinner styles */
        #loadingSpinner {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin-top: 10px;
        }

        /* Keyframe for spinner animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

    <h2>Email Validation Tool</h2>
    <input type="text" id="emailInput" placeholder="Enter emails separated by commas">
    <button onclick="validateEmails()">Validate Emails</button>

    <div id="loadingSpinner"></div> <!-- Loading Spinner -->

    <h3>Valid Emails</h3>
    <div id="validEmailsBox"></div>

    <h3>Invalid Emails</h3>
    <div id="invalidEmailsBox"></div>

    <button onclick="copyValidatedEmails()">Copy Valid Emails</button>

    <script>
        const validEmails = [];
        const invalidEmails = [];

        async function validateEmails() {
            const emailInput = document.getElementById('emailInput').value;
            const emails = emailInput.split(',');

            // Clear previous results
            validEmails.length = 0;
            invalidEmails.length = 0;
            document.getElementById('validEmailsBox').innerHTML = '';
            document.getElementById('invalidEmailsBox').innerHTML = '';

            // Show loading spinner
            document.getElementById('loadingSpinner').style.display = 'block';

            // Send emails to the server for validation
            const response = await fetch('/validate-emails', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ emails }),
            });

            const result = await response.json();

            // Handle valid emails
            result.validEmails.forEach(email => {
                validEmails.push(email);
                const emailDiv = document.createElement('div');
                emailDiv.textContent = email;
                document.getElementById('validEmailsBox').appendChild(emailDiv);
            });

            // Handle invalid emails
            result.invalidEmails.forEach(email => {
                invalidEmails.push(email);
                const emailDiv = document.createElement('div');
                emailDiv.textContent = email;
                document.getElementById('invalidEmailsBox').appendChild(emailDiv);
            });

            // Hide loading spinner
            document.getElementById('loadingSpinner').style.display = 'none';
        }

        // Copy validated emails to clipboard
        function copyValidatedEmails() {
            if (validEmails.length === 0) {
                alert("No valid emails to copy!");
                return;
            }

            const textToCopy = validEmails.join('\n');
            const textArea = document.createElement('textarea');
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            alert('Valid emails copied to clipboard!');
        }
    </script>

</body>
</html>
